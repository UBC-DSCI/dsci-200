{
  "hash": "b5e754f345698f06ac8889e26aea2c9e",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlecture: \"Outliers I\"\nformat: revealjs\nmetadata-files: \n  - _metadata.yml\n---\n\n\n## {{< meta lecture >}} {.large background-image=\"img/smooths.png\" background-opacity=\"0.3\" background-size=\"50%\"}\n\n[DSCI 200]{.secondary}\n\n[{{< meta author >}}]{.secondary}\n\nLast modified -- 23 February 2026\n\n\n\n\n\n$$\n\\DeclareMathOperator*{\\argmin}{argmin}\n\\DeclareMathOperator*{\\argmax}{argmax}\n\\DeclareMathOperator*{\\minimize}{minimize}\n\\DeclareMathOperator*{\\maximize}{maximize}\n\\DeclareMathOperator*{\\find}{find}\n\\DeclareMathOperator{\\st}{subject\\,\\,to}\n\\newcommand{\\E}{E}\n\\newcommand{\\Expect}[1]{\\E\\left[ #1 \\right]}\n\\newcommand{\\Var}[1]{\\mathrm{Var}\\left[ #1 \\right]}\n\\newcommand{\\Cov}[2]{\\mathrm{Cov}\\left[#1,\\ #2\\right]}\n\\newcommand{\\given}{\\ \\vert\\ }\n\\newcommand{\\X}{\\mathbf{X}}\n\\newcommand{\\x}{\\mathbf{x}}\n\\newcommand{\\y}{\\mathbf{y}}\n\\newcommand{\\P}{\\mathcal{P}}\n\\newcommand{\\R}{\\mathbb{R}}\n\\newcommand{\\norm}[1]{\\left\\lVert #1 \\right\\rVert}\n\\newcommand{\\snorm}[1]{\\lVert #1 \\rVert}\n\\newcommand{\\tr}[1]{\\mbox{tr}(#1)}\n\\newcommand{\\brt}{\\widehat{\\beta}^R_{s}}\n\\newcommand{\\brl}{\\widehat{\\beta}^R_{\\lambda}}\n\\newcommand{\\bls}{\\widehat{\\beta}_{ols}}\n\\newcommand{\\blt}{\\widehat{\\beta}^L_{s}}\n\\newcommand{\\bll}{\\widehat{\\beta}^L_{\\lambda}}\n\\newcommand{\\U}{\\mathbf{U}}\n\\newcommand{\\D}{\\mathbf{D}}\n\\newcommand{\\V}{\\mathbf{V}}\n$$\n\n\n\n\n## Attribution\n<br>\n\n- Some examples and references are from [*Challenges of cellwise outliers*, by Raymaekers and Rousseeuw](https://www.sciencedirect.com/science/article/pii/S2452306224000078) \n\n- [*Robust Statistics*, by Maronna, Martin, Yohai, Salibian-Barrera](https://onlinelibrary.wiley.com/doi/book/10.1002/9781119214656)\n\n<br>\n\n*In memory of my mentor and friend*\n\nProfessor Ruben Zamar (1949-2023)\n\nwho contributed greatly to Robust Statistics and beyond ...\n\n<br><br>\n\n## Learning Objectives {.scrollable}\n\n<br>\nBy the end of this lesson, you will be able to:\n\n:::incremental\n- Determine potential reasons why data contain outliers.\n- Compare outliers with extreme values generated from heavy-tailed distributions.\n- Recognize different types of outliers in a data set (e.g., casewise versus cellwise outliers).\n- Use different methods to detect outliers in a data set and understand differences in the results.\n- Justify and apply strategies for managing outliers in the data, including transformations and data imputation.\n- Write a computer script to evaluate the impact that outliers can have on subsequent analyses through simulation.\n- Reflect on the consequences with regards to the conclusions of the chosen method.\n- Recognize the importance of utilizing domain knowledge when handling outliers.\n:::\n\n## What is an outlier?\n\n![](img/pexels-outlier.png)\n\n## Outliers\n\n::: {.callout-note title=\"Definition: Outlier\"}\nAn **outlier** is an observation that deviates from the bulk of the data, an atypical observation. \n:::\n\n#### Outliers may arise from:\n\n- errors when collecting or processing data\n\n- values generated from a different distribution\n\n- rare cases which may carry valuable information\n\n<br>\n\nAs with missing values, outliers require careful diagnosis and appropriate handling before analysis.\n\n## Casewise *vs* Cellwise\n\n![](img/Case_Cell.png)\n\n## Casewise \n\n::: {.columns}\n\n::: {.column width=\"45%\"}\n![](img/Case.png)\n:::\n\n::: {.column width=\"55%\" .v-center}\n\n<br><br>\nIn the 1960s Tukey and Huber introduced the *casewise* (aka rowwise) contamination model \n\n- Treats entire rows as contaminated and coming from a different distribution, even if only values of some variables are unusual\n\n- Assumes that less than 50% of the cases (objects) are contaminated\n\n:::\n:::\n\n## Cellwise\n\n::: {.columns}\n\n::: {.column width=\"45%\"}\n![](img/Cell.png)\n:::\n\n::: {.column width=\"55%\" .v-center}\n\n<br><br>\n\nIn 2009, Alqallaf, Van Aelst, Yohai and Zamar introduced the *cellwise* contamination model\n\n- Only individual cells are contaminated, with values coming from a different distribution\n\n- Any case (row) may contain some contaminated cells\n\n- More realistic for high-dimensional data\n\n:::\n:::\n\n## Glass data\n\n![](img/glass.png)\n\nData: n = 180 archeological glass spectra with d = 750 wavelengths ([Detecting Deviating Data Cells](https://www.tandfonline.com/doi/figure/10.1080/00401706.2017.1340909?scroll=top&needAccess=true), Rousseeuw & Van Den Bossche, *Technometrics* 2018)\n\n## Univariate estimators\n\nBefore analyzing multivariate datasets, we first need to learn how to identify and handle outlying values in a single variable.\n\nLet's look at the values of the wavelength V169 in this data\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](outliers-1_files/figure-revealjs/unnamed-chunk-1-1.svg){fig-align='center'}\n:::\n:::\n\n\n\n## Robust estimators\n\n- Classical estimators can be highly distorted by outliers\n\n- Robust estimators are needed to capture the bulk of the data\n\n- Robust estimators are also needed to flag outliers\n\n<br>\n\n| Statistic | Estimate |\n|-----------|----------|\n| Mean      | 5260.72 |\n| Median    | 4629 |\n| SD        | 1413.69 |\n| MAD       | 470.73 |\n\n<br>\n\n#### The mean and SD are very sensitive to the outliers in the data\n\n## Mean ($\\bar{X}$) *vs* Median ($\\tilde{X}$)\n\nIf the median is less affected by extreme values, why not using it as a default?\n\n- if the data contain outliers, the median is more resistant\n\n- but if the data does not contain outliers, it is less efficient (larger standard error!)\n\n#### If data is Normally distributed:\n\n$$SE(\\bar{X}) = \\frac{\\sigma}{\\sqrt{n}}$$\n\n$$SE(\\tilde{X})= \\sqrt{\\frac{\\pi}{2}}\\frac{\\sigma}{\\sqrt{n}}$$\n\nLet's examine these two points by simulation!\n\n## Simulation design\n\n### Clean data\n\n- Generate a sample of size 100 from a Normal distribution with mean 0 and standard deviation 1\n\n- Compute the mean and the median\n\n- Repeat 10000 times\n\n- Summarize their sampling distributions\n\n\n##\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(200)\n\nsim_stats <- replicate(10000, {\n  x <- rnorm(100)\n  c(mean = mean(x),\n    median = median(x))\n})\n\nsim_stats <- t(sim_stats) |> as.data.frame()\n\nsd(sim_stats$mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1006556\n```\n\n\n:::\n\n```{.r .cell-code}\n1/sqrt(1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.03162278\n```\n\n\n:::\n\n```{.r .cell-code}\nsd(sim_stats$median)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1255247\n```\n\n\n:::\n\n```{.r .cell-code}\nsqrt(pi/2)*0.001\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.001253314\n```\n\n\n:::\n:::\n\n\n\n##\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](outliers-1_files/figure-revealjs/unnamed-chunk-3-1.svg){fig-align='center'}\n:::\n:::\n\n\n\n## Simulation design\n\n### Contaminated data\n\n- Generate a sample of size 100, with 90% from $\\mathcal{N}(0,1)$ and 10% from $\\mathcal{N}(0,10)$\n\n- Compute the mean and the median\n\n- Repeat 10000 times\n\n- Summarize their sampling distributions\n\n$$\\text{Var}(\\bar{X}) = \\frac{(1-\\varepsilon)\\sigma^2_1 + \\varepsilon \\sigma_2^2}{n}$$\n\n$$\\mathrm{Var}(\\tilde{X}) \\approx \\frac{\\pi}{2n}\\;\n\\frac{1}{\\left(\\frac{1-\\varepsilon}{\\sigma_1}+\\frac{\\varepsilon}{\\sigma_2}\\right)^2}$$\n\n##\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrcont_norm <- function(n, eps = 0.10, mu0 = 0, \n                       sigma0 = 1, sigma1 = 10) {\n  x <- rnorm(n, mean = mu0, sd = sigma0)\n  \n  k <- ceiling(eps * n)              \n  if (k > 0) {\n    idx <- sample(1:n, k)\n    x[idx] <- rnorm(k, mean = mu0, sd = sigma1)\n  }\n  x\n}\n\nset.seed(200)\n\nsim_stats <- replicate(10000, {\n  x <- rcont_norm(100)\n  c(mean = mean(x),\n    median = median(x))\n})\n\nsim_stats <- t(sim_stats) |> as.data.frame()\n\nsd(sim_stats$mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3307419\n```\n\n\n:::\n\n```{.r .cell-code}\nsd(sim_stats$median)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1374634\n```\n\n\n:::\n\n```{.r .cell-code}\ndd <- (.9/1 + .1/10)^2\nsqrt(pi/(2*100*dd))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1377268\n```\n\n\n:::\n:::\n\n\n\n## Key Takeaways\n\n<br>\n\n- Outliers can occur in all variables of an observation or only in certain variables\n\n- Cellwise paradigm is better is more flexible for high-dimensional data\n\n- Classical estimators can be optimal but very sensitive to outliers\n\n- Median is less efficient (≈ 1.57× variance) but more stable under contamination\n\n- Robustness = trade-off with efficiency\n\n\n\n",
    "supporting": [
      "outliers-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}